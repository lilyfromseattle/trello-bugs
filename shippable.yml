# Language setting
language: node_js

# Version number
node_js:
  - 0.10.25

# The path for Xunit to output test reports
env:
    global:
      - CI_REPORTS=shippable/testresults COVERAGE_REPORTS=shippable/codecoverage
      - XUNIT_FILE=shippable/testresults/result.xml
      - APP_NAME=trello-bug-counter
      - secure: j/UZL04OYmQbqaKsNicxtp7gRRFJbNFSsXY6eX4xoqWLV5OSKKhGOcVN0sgcevUWYvziZ4y48L5we7rU0YbFFHrLj2Bx8815pgur5WSPUhIqtxXfzGu4d/7iug0ItMZeBekNj/7rI6co2ALxb9n/COkTcA1p/xQirRQthEALlSQ374bIa+HPJGO2qE7jGaw5lkkBCOI1y/sHnsuPSn6hLtnubkgc/317s29ThkjUF7teC+b4mH+fEx+g8BtU+YZHV+9ZqRtSL+xnJ6/G0c6IwmBLoxUNuY+jsoJiMrdKjmfJC1ONXziqx2NjGQ7g6oTXt3Dej5fRy6fhv9QBHtG+mQ==
# Create directories for test and coverage reports
before_install:
  - npm install

before_script:
  - mkdir -p shippable/testresults
  - mkdir -p shippable/codecoverage

script:
  - npm run mocha-test
  - git push -f git@heroku.com:$APP_NAME.git master
  - npm run casper-test
# Running the tests with grunt

# Tell istanbul to generate a coverage report
after_script:
  - ./node_modules/.bin/istanbul cover grunt -- -u tdd
  - ./node_modules/.bin/istanbul report cobertura --dir  shippable/codecoverage/
