# Language setting
language: node_js

# Version number
node_js:
  - 0.10.25

# The path for Xunit to output test reports
env:
    global:
      - CI_REPORTS=shippable/testresults COVERAGE_REPORTS=shippable/codecoverage
      - XUNIT_FILE=shippable/testresults/result.xml
      - APP_NAME=trello-bug-counter
      - secure: dN/qAYg+0rvq5fCoy621E93fKyN26drBR7J68+eebl4uTHusjXOYrKDnl/NSyZzzej0AWOFr2TBGYzraP0BLZnYiI/Wzt9B36Po0I1EUJG6UqlK29OQouiUugxhGTrfmiUewmmt/UoO55bEEQjEnDZvNRI6+QDCN1880u7Y4hjtr2mxMHlbGwjRaOAoLF0sRL8G3sACmTMdMGf3UsLZRflvCX6LS0eFU6KECTGCrJU9+ceXjC4kQI8dXjEh8nE8wdRjnRUZWsrxD5VvMlOajWzC88c9TxyTRhXZ0Owq/zRlU9l9vYuoDFoL9zbYkNhY/UvIhwhz2k8UdyG+KRV7eaQ==

# Create directories for test and coverage reports
before_install:
  - npm install

before_script:
  - mkdir -p shippable/testresults
  - mkdir -p shippable/codecoverage

script:
  - npm run mocha-test
  - git push -f git@heroku.com:$APP_NAME.git master
  - npm run casper-test
# Running the tests with grunt

# Tell istanbul to generate a coverage report
after_script:
  - ./node_modules/.bin/istanbul cover grunt -- -u tdd
  - ./node_modules/.bin/istanbul report cobertura --dir  shippable/codecoverage/
